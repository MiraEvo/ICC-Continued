<UserControl x:Class="Ink_Canvas.Views.Settings.Pages.PowerPointSettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:local="clr-namespace:Ink_Canvas.Views.Settings.Pages"
             xmlns:converters="clr-namespace:Ink_Canvas.Converters"
             mc:Ignorable="d"
             d:DesignHeight="1000" d:DesignWidth="800"
             Background="Transparent">

    <UserControl.Resources>
        <converters:BooleanToOpacityConverter x:Key="BooleanToOpacityConverter"/>
        <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter"/>
        <converters:BooleanToBackgroundConverter x:Key="BooleanToBackgroundConverter"/>
    </UserControl.Resources>

    <ui:DynamicScrollViewer VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
        <StackPanel Margin="0,0,12,24">
            <!-- Header -->
            <ui:TextBlock Text="PowerPoint 支持" FontTypography="Title" Margin="0,0,0,12" />
            <ui:TextBlock Text="此部分的设置项将会在幻灯片播放时使用，优先级高于其他设置项"
                          FontTypography="Body" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,24"/>

            <!-- Microsoft PowerPoint Support -->
            <ui:CardControl Margin="0,0,0,12">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="SlidePlay24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <StackPanel>
                        <ui:TextBlock Text="Microsoft PowerPoint 支持" FontTypography="Body"/>
                        <ui:TextBlock Text="启用对 Microsoft Office PowerPoint 的支持" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding PowerPoint.PowerPointSupport, Mode=TwoWay}"/>
            </ui:CardControl>

            <!-- WPS Office Support -->
            <ui:CardControl Margin="0,0,0,12">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="SlideMultiple24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <StackPanel>
                        <ui:TextBlock Text="WPS Office 支持" FontTypography="Body"/>
                        <ui:TextBlock Text="启用对 Kingsoft WPS Office 的支持" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding PowerPoint.IsSupportWPS, Mode=TwoWay}"/>
            </ui:CardControl>

            <!-- WPS Warning -->
            <ui:InfoBar Severity="Warning" IsOpen="{Binding PowerPoint.IsSupportWPS, Mode=OneWay}" 
                        Title="不建议使用 WPS"
                        Message="由于WPS的API实现存在问题，开启后可能会导致退出WPS时卡顿，请谨慎开启！此外，若要启用WPS支持，请确保 WPS 是否在“配置工具”中开启了“WPS Office 兼容第三方系统和软件”选项。"
                        Margin="0,0,0,24" />

            <!-- PPT Enhanced Support -->
            <ui:CardExpander Margin="0,0,0,24" IsExpanded="{Binding PowerPoint.IsEnablePPTEnhancedSupport, Mode=OneWay}">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="Rocket24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <ui:TextBlock Text="PPT 联动增强" FontTypography="Body"/>
                            <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                <TextBlock Text="实验性" FontSize="10" Foreground="White"/>
                            </Border>
                        </StackPanel>
                        <ui:TextBlock Text="基于智绘教 Inkeys 的 PPT 演示助手 3 技术方案" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardExpander.Header>
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="启用增强支持" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding PowerPoint.IsEnablePPTEnhancedSupport, Mode=TwoWay}"/>
                    </Grid>

                    <ui:InfoBar Severity="Informational" IsOpen="True" IsClosable="False" Margin="0,0,0,0"
                                Title="功能特性"
                                Message="• 识别 COM 注册损坏的 PowerPoint 和 WPS&#10;• 动态切换，优先绑定最上层的放映窗口&#10;• 兼容至 Microsoft PowerPoint 2007 和 Kingsoft WPS 2013&#10;• 轮询和事件注册双模式，应对 COM 损坏严重的情况&#10;• 支持在 WPS 未勾选「兼容第三方系统和软件」时连接"/>
                </StackPanel>
            </ui:CardExpander>

            <!-- Registry Hacks -->
            <ui:CardExpander Margin="0,0,0,24" IsExpanded="False">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="Edit24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <ui:TextBlock Text="注册表修改" FontTypography="Body"/>
                            <Border Background="#F59E0B" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                <TextBlock Text="管理员" FontSize="10" Foreground="White"/>
                            </Border>
                        </StackPanel>
                        <ui:TextBlock Text="以下功能会修改注册表，操作前请先备份" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardExpander.Header>
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="PPT放映时不显示自带工具栏" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding PowerPoint.RegistryShowSlideShowToolbar, Mode=TwoWay}"/>
                    </Grid>

                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="PPT放映结束时是否显示黑色背景页面" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding PowerPoint.RegistryShowBlackScreenLastSlideShow, Mode=TwoWay}"/>
                    </Grid>

                    <Grid Margin="0,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="PPT强制禁用两侧工具栏按钮" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding PowerPoint.RegistryDisableSideToolbar, Mode=TwoWay}"/>
                    </Grid>
                </StackPanel>
            </ui:CardExpander>

        </StackPanel>
    </ui:DynamicScrollViewer>
</UserControl>
