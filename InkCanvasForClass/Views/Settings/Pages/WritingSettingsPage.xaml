<UserControl x:Class="Ink_Canvas.Views.Settings.Pages.WritingSettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:local="clr-namespace:Ink_Canvas.Views.Settings.Pages"
             mc:Ignorable="d"
             d:DesignHeight="1200" d:DesignWidth="800"
             Background="Transparent">

    <ui:DynamicScrollViewer VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
        <StackPanel Margin="0,0,12,24">
            <!-- Header -->
            <ui:TextBlock Text="书写" FontTypography="Title" Margin="0,0,0,8" />
            <ui:TextBlock Text="书写与墨迹行为相关设置" FontTypography="Body" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,24" />

            <!-- 画板和墨迹 -->
            <ui:TextBlock Text="画板和墨迹" FontTypography="BodyStrong" Margin="0,0,0,8"/>

            <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="Edit24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                     <ui:TextBlock Text="显示画笔光标" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding Whiteboard.IsShowCursor, Mode=TwoWay}"/>
            </ui:CardControl>

            <ui:CardControl Margin="0,0,0,24">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="EraserTool24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <StackPanel>
                        <ui:TextBlock Text="橡皮大小" FontTypography="Body"/>
                        <ui:TextBlock Text="非实时切换，下一次使用画板擦时生效。" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                <ComboBox MinWidth="120" SelectedIndex="{Binding Whiteboard.EraserSize, Mode=TwoWay}">
                    <ComboBoxItem Content="很小"/>
                    <ComboBoxItem Content="较小"/>
                    <ComboBoxItem Content="中等"/>
                    <ComboBoxItem Content="较大"/>
                    <ComboBoxItem Content="很大"/>
                </ComboBox>
            </ui:CardControl>

            <!-- 手掌橡皮 -->
             <ui:TextBlock Text="手掌橡皮" FontTypography="BodyStrong" Margin="0,0,0,8"/>
             
             <ui:CardExpander Margin="0,0,0,24" IsExpanded="True">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="HandRight24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <ui:TextBlock Text="手掌橡皮设置" FontTypography="Body"/>
                </ui:CardExpander.Header>
                <StackPanel>
                     <!-- Toggle Switch for Palm Detection -->
                     <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="触摸移动检测手掌" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding Gesture.PalmEraserDetectOnMove, Mode=TwoWay}"/>
                     </Grid>
                     
                     <!-- Sliders -->
                     <!-- Threshold -->
                     <Grid Margin="0,0,0,12">
                         <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                         </Grid.ColumnDefinitions>
                         <ui:TextBlock Text="触发稳定次数" VerticalAlignment="Center"/>
                         <Slider Grid.Column="1" Minimum="1" Maximum="6" Value="{Binding Gesture.PalmEraserDetectionThreshold, Mode=TwoWay}" TickFrequency="1" IsSnapToTickEnabled="True" Margin="12,0"/>
                         <ui:TextBlock Grid.Column="2" Text="{Binding Gesture.PalmEraserDetectionThreshold, StringFormat='{}{0}次'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                     </Grid>

                     <!-- Min Interval -->
                     <Grid Margin="0,0,0,12">
                         <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                         </Grid.ColumnDefinitions>
                         <ui:TextBlock Text="最小更新间隔" VerticalAlignment="Center"/>
                         <Slider Grid.Column="1" Minimum="0" Maximum="60" Value="{Binding Gesture.PalmEraserMinIntervalMs, Mode=TwoWay}" TickFrequency="2" IsSnapToTickEnabled="True" Margin="12,0"/>
                         <ui:TextBlock Grid.Column="2" Text="{Binding Gesture.PalmEraserMinIntervalMs, StringFormat='{}{0}ms'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                     </Grid>
                     
                     <ui:TextBlock Text="数值越大越不容易触发，同时可提升稳定性。" Foreground="{DynamicResource TextFillColorSecondaryBrush}" FontTypography="Caption" TextWrapping="Wrap"/>

                     <ui:TextBlock Text="智能检测参数" FontTypography="BodyStrong" Margin="0,16,0,8"/>

                     <!-- Adaptive Threshold Toggle -->
                     <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="使用自适应阈值" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding Gesture.UseAdaptiveThreshold, Mode=TwoWay}"/>
                     </Grid>

                     <!-- Predictive Erasing Toggle -->
                     <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="预测性擦除" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding Gesture.UsePredictiveErasing, Mode=TwoWay}"/>
                     </Grid>

                     <!-- Probability Threshold -->
                     <Grid Margin="0,0,0,12">
                         <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                         </Grid.ColumnDefinitions>
                         <ui:TextBlock Text="手掌概率阈值" VerticalAlignment="Center"/>
                         <Slider Grid.Column="1" Minimum="0.5" Maximum="0.95" Value="{Binding Gesture.PalmProbabilityThreshold, Mode=TwoWay}" TickFrequency="0.05" IsSnapToTickEnabled="True" Margin="12,0"/>
                         <ui:TextBlock Grid.Column="2" Text="{Binding Gesture.PalmProbabilityThreshold, StringFormat='{}{0:F2}'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                     </Grid>

                     <!-- Velocity Threshold -->
                     <Grid Margin="0,0,0,12">
                         <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                         </Grid.ColumnDefinitions>
                         <ui:TextBlock Text="速度阈值" VerticalAlignment="Center"/>
                         <Slider Grid.Column="1" Minimum="0.1" Maximum="2.0" Value="{Binding Gesture.PalmEraserVelocityThreshold, Mode=TwoWay}" TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                         <ui:TextBlock Grid.Column="2" Text="{Binding Gesture.PalmEraserVelocityThreshold, StringFormat='{}{0:F1}'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                     </Grid>

                     <!-- Touch History Size -->
                     <Grid Margin="0,0,0,12">
                         <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                         </Grid.ColumnDefinitions>
                         <ui:TextBlock Text="历史记录大小" VerticalAlignment="Center"/>
                         <Slider Grid.Column="1" Minimum="5" Maximum="50" Value="{Binding Gesture.TouchHistorySize, Mode=TwoWay}" TickFrequency="5" IsSnapToTickEnabled="True" Margin="12,0"/>
                         <ui:TextBlock Grid.Column="2" Text="{Binding Gesture.TouchHistorySize, StringFormat='{}{0}'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                     </Grid>

                     <ui:TextBlock Text="现代化检测使用多特征融合算法，结合面积、形状、速度等多维度特征进行智能识别。" Foreground="{DynamicResource TextFillColorSecondaryBrush}" FontTypography="Caption" TextWrapping="Wrap"/>
                </StackPanel>
             </ui:CardExpander>

             <!-- Ink Correction -->
             <ui:TextBlock Text="墨迹纠正" FontTypography="BodyStrong" Margin="0,0,0,8"/>

             <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="Shapes24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="启用墨迹识别" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding InkToShape.IsInkToShapeEnabled, Mode=TwoWay}"/>
             </ui:CardControl>

             <ui:CardExpander Margin="0,0,0,4">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="TopSpeed24"/> 
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <ui:TextBlock Text="模拟压感值" FontTypography="Body"/>
                </ui:CardExpander.Header>
                <StackPanel>
                     <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="阻止矫正后的矩形带有模拟压感值" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding InkToShape.IsInkToShapeNoFakePressureRectangle, Mode=TwoWay}"/>
                     </Grid>
                     <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="阻止矫正后的三角形带有模拟压感值" VerticalAlignment="Center"/>
                        <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding InkToShape.IsInkToShapeNoFakePressureTriangle, Mode=TwoWay}"/>
                     </Grid>
                </StackPanel>
             </ui:CardExpander>

             <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="SelectObject24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="将识别的墨迹当作形状处理" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding InkToShape.TreatRecognizedInkAsShape, Mode=TwoWay}"/>
             </ui:CardControl>

             <ui:CardExpander Margin="0,0,0,24">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="CheckboxChecked24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <ui:TextBlock Text="矫正手绘形状类型" FontTypography="Body"/>
                </ui:CardExpander.Header>
                <StackPanel>
                     <CheckBox Content="矫正手绘三角形" IsChecked="{Binding InkToShape.IsInkToShapeTriangle, Mode=TwoWay}" Margin="0,0,0,12"/>
                     <CheckBox Content="矫正手绘矩形" IsChecked="{Binding InkToShape.IsInkToShapeRectangle, Mode=TwoWay}" Margin="0,0,0,12"/>
                     <CheckBox Content="矫正手绘圆形与椭圆" IsChecked="{Binding InkToShape.IsInkToShapeRounded, Mode=TwoWay}"/>
                </StackPanel>
             </ui:CardExpander>

             <!-- Shape Drawing -->
             <ui:TextBlock Text="形状绘制" FontTypography="BodyStrong" Margin="0,0,0,8"/>
             
             <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="Toolbox24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <StackPanel>
                        <ui:TextBlock Text="启用绘制时工具栏" FontTypography="Body"/>
                        <ui:TextBlock Text="启用绘制工具栏后，可以在绘制形状时显示一个工具栏，可以快捷进行变体的切换、形状绘制属性，关闭该选项后将无法修改形状变体！" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" TextWrapping="Wrap"/>
                    </StackPanel>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding InkToShape.EnableDrawingToolbar, Mode=TwoWay}"/>
             </ui:CardControl>
             
             <ui:CardControl Margin="0,0,0,4">
               <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="PanelRightExpand20"/>
               </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="工具栏默认展开形状变体栏" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding InkToShape.ExpandShapeVariantsByDefault, Mode=TwoWay}"/>
             </ui:CardControl>
        </StackPanel>
    </ui:DynamicScrollViewer>
</UserControl>
