<UserControl x:Class="Ink_Canvas.Views.Settings.Pages.SnapshotSettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:local="clr-namespace:Ink_Canvas.Views.Settings.Pages"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="600"
             Background="Transparent">

    <UserControl.Resources>
        <ResourceDictionary>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <ui:DynamicScrollViewer VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
        <StackPanel Margin="0,0,12,24">
            <ui:TextBlock Text="截图" FontTypography="Title" Margin="0,0,0,8" />
            <ui:TextBlock Text="配置截图行为与选项" FontTypography="Body" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,24" />

            <!-- Magnification API Screenshot -->
            <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="Camera24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <ui:TextBlock Text="使用 Magnification API 截图" FontTypography="Body"/>
                            <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                <TextBlock Text="实验性" FontSize="10" Foreground="White"/>
                            </Border>
                        </StackPanel>
                        <ui:TextBlock Text="使用 Magnification API 和弃用的函数 MagSetImageScalingCallback 实现过滤 ICC 窗口截图。" 
                                      FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding Snapshot.ScreenshotUsingMagnificationAPI, Mode=TwoWay}"/>
            </ui:CardControl>

            <ui:InfoBar Severity="Warning" IsOpen="True" IsClosable="False" 
                        Visibility="{Binding Snapshot.ScreenshotUsingMagnificationAPI, Converter={StaticResource BooleanToVisibilityConverter}}"
                        Title="该功能为高度实验性选项"
                        Message="该功能使用的 MagSetImageScalingCallback 函数在 Win7 及更高版本中已弃用，经测试，只有 Win8、Win8.1、Win10 系统可以使用该功能，Win11已经失效。该功能极度不稳定，可能会导致截屏时黑屏或系统崩溃，请按需开启。"
                        Margin="0,0,0,12"/>

            <!-- Other Settings -->
            <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="Clipboard24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="截图后以 .png 格式复制到剪贴板" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding Snapshot.CopyScreenshotToClipboard, Mode=TwoWay}"/>
            </ui:CardControl>

            <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="EyeOff24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="截图时隐藏 ICC 主窗口" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding Snapshot.HideMainWinWhenScreenshot, Mode=TwoWay}"/>
            </ui:CardControl>

            <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="Pen24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="截图时附加墨迹到截图文件上" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding Snapshot.AttachInkWhenScreenshot, Mode=TwoWay}"/>
            </ui:CardControl>

            <ui:CardControl Margin="0,0,0,4">
                <ui:CardControl.Icon>
                    <ui:SymbolIcon Symbol="ResizeLarge24"/>
                </ui:CardControl.Icon>
                <ui:CardControl.Header>
                    <ui:TextBlock Text="窗口截图只截取最大化窗口" FontTypography="Body"/>
                </ui:CardControl.Header>
                <ui:ToggleSwitch IsChecked="{Binding Snapshot.OnlySnapshotMaximizeWindow, Mode=TwoWay}"/>
            </ui:CardControl>

            <ui:CardExpander Margin="0,0,0,24" IsExpanded="True">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="Rename24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <ui:TextBlock Text="截图文件名模板" FontTypography="Body"/>
                </ui:CardExpander.Header>
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBlock Text="文件名模板" VerticalAlignment="Center" Margin="0,0,16,0"/>
                        <TextBox Grid.Column="1" Text="{Binding Snapshot.ScreenshotFileName, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center"/>
                        <ui:Button Grid.Column="2" Content="重置" Margin="12,0,0,0" VerticalAlignment="Center" Click="ResetFileNameButton_Click"/>
                    </Grid>
                    
                    <ui:TextBlock Text="模板变量参考：" FontTypography="BodyStrong" Margin="0,0,0,8"/>
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <ui:TextBlock Text="[YYYY] - 日期年份" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            <ui:TextBlock Text="[HH] - 日期小时" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            <ui:TextBlock Text="[width] - 图片宽度" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                        <StackPanel Grid.Column="1">
                            <ui:TextBlock Text="[MM] - 日期月份" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            <ui:TextBlock Text="[mm] - 日期分钟数" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            <ui:TextBlock Text="[height] - 图片高度" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2">
                            <ui:TextBlock Text="[DD] - 日期号数" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            <ui:TextBlock Text="[ss] - 日期秒数" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </ui:CardExpander>

        </StackPanel>
    </ui:DynamicScrollViewer>
</UserControl>
